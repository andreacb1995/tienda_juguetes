<div class="perfil-container">
  <div class="header-perfil">
    <button class="btn-volver" (click)="volverAInicio()">
      ← Volver a la tienda
    </button>
    <button class="btn-cerrar-sesion" (click)="cerrarSesion()">
      Cerrar Sesión
    </button>
  </div>

  <div class="perfil-container">
    <mat-tab-group>
      <mat-tab label="Datos Personales">
        <div class="datos-personales" *ngIf="usuario">
          <h2 class="seccion-titulo">Mis Datos Personales</h2>
          
          <div class="datos-card">
            <div class="datos-seccion">
              <h3>Información de Cuenta</h3>
              <div class="campo-dato">
                <span class="etiqueta">Usuario:</span>
                <span class="valor">{{usuario.username}}</span>
              </div>
            </div>

            <div class="datos-seccion">
              <h3>Información Personal</h3>
              <div class="campo-dato">
                <span class="etiqueta">Nombre completo:</span>
                <span class="valor">{{usuario.nombre}} {{usuario.apellidos}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Email:</span>
                <span class="valor">{{usuario.email}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Teléfono:</span>
                <span class="valor">{{usuario.telefono}}</span>
              </div>
            </div>

            <div class="datos-seccion">
              <h3>Dirección de Envío</h3>
              <div class="campo-dato">
                <span class="etiqueta">Calle y número:</span>
                <span class="valor">{{usuario.direccion?.calle}} {{usuario.direccion?.numero}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Piso:</span>
                <span class="valor">{{usuario.direccion?.piso || 'No especificado'}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Código Postal:</span>
                <span class="valor">{{usuario.direccion?.codigoPostal}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Ciudad:</span>
                <span class="valor">{{usuario.direccion?.ciudad}}</span>
              </div>
              <div class="campo-dato">
                <span class="etiqueta">Provincia:</span>
                <span class="valor">{{usuario.direccion?.provincia}}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Mensaje cuando no hay usuario -->
        <div class="no-datos" *ngIf="!usuario">
          <p>No se pudieron cargar los datos del usuario</p>
        </div>
      </mat-tab>
      
      <mat-tab label="Mis Pedidos">
        <div class="pedidos-lista">
          <h2>Historial de Pedidos</h2>
          <div class="pedidos-grid" *ngIf="pedidos.length > 0">
            <div class="pedido-card" *ngFor="let pedido of pedidos">
              <div class="pedido-header">
                <span class="pedido-fecha">{{pedido.fechaPedido | date:'dd/MM/yyyy'}}</span>
                <span class="pedido-estado" [class]="pedido.estado">{{pedido.estado}}</span>
              </div>
              <div class="pedido-productos">
                <div class="producto-item" *ngFor="let producto of pedido.productos">
                  <span class="producto-nombre">{{producto.nombre}}</span>
                  <span class="producto-cantidad">x{{producto.cantidad}}</span>
                  <span class="producto-precio">{{producto.precio | currency:'EUR'}}</span>
                </div>
              </div>
              <div class="pedido-footer">
                <span class="pedido-total">Total: {{pedido.total | currency:'EUR'}}</span>
              </div>
            </div>
          </div>
          <div class="no-pedidos" *ngIf="pedidos.length === 0">
            No tienes pedidos realizados
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>

</div>